package com.formacionbdi.microservicios.app.usuarios.models.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import com.formacionbdi.microservicios.commnos.alumnos.models.entity.Alumno;



// Capa repositorio

/* También se podría usar directamente en el controlador, pero
 * no es buena practica. Lo ideal es desacoplar porque podriamos tener
 * un controlador con varios accesos a objetos repositorios. MVC
 * 
 */

//public interface AlumnoRepository extends CrudRepository<nombreClaseEntity, tipoID>


// public interface AlumnoRepository extends CrudRepository<Alumno, Long> {
public interface AlumnoRepository extends JpaRepository<Alumno, Long> {

	
	/*
	 * esta no es un consulta nativa en la bbdd; es una consulta Hibernate o JPA Query (HQL).
	 * 
	 * SELECT
	 * 	alumnos.*
	 * FROM
	 * 	alumnos
	 * WHERE
	 * 	alumnos.nombre LIKE '%andr%' OR
	 * 	alumnos.apellido LIKE '%cast%'
	 */
	@Query("select "
			+ 		"alum "
			+ "from "
			+ 		"Alumno alum "
			+ "where "
			+ 		"lower(alum.nombre) like lower(concat('%', ?1, '%')) or lower(alum.apellido) like lower(%?1%)")
	public List<Alumno> findByNombreOrApellido(String termino);
	
}
